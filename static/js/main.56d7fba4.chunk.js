(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{264:function(t,e,n){},272:function(t,e){},273:function(t,e){},281:function(t,e){},291:function(t,e){},292:function(t,e){},293:function(t,e){},294:function(t,e){},302:function(t,e){},305:function(t,e,n){"use strict";n.r(e);var a=n(112),s=n.n(a),r=n(236),i=n.n(r),c=(n(264),n(19)),o=n(4),d=n.n(o),l=n(11),u=n(6),p=n(10),b=n(42),m=n(14),h=n(15),y=(n.p,n(266),n(81)),j=(n(303),n(40)),f=function(t){Object(m.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(u.a)(this,n),(t=e.call(this)).state={imguploaded:!1,picurl:void 0,tensor:void 0,model:void 0,predictarray:void 0,actmap:void 0,maskedImgArray:void 0,maskedImgArrayprogress:void 0,test:void 0,test2:void 0,test3:void 0},t.loadPic=t.loadPic.bind(Object(b.a)(t)),t.getTensor=t.getTensor.bind(Object(b.a)(t)),t.loadModel=t.loadModel.bind(Object(b.a)(t)),t.predict=t.predict.bind(Object(b.a)(t)),t.activationMap=t.activationMap.bind(Object(b.a)(t)),t.maskedImgArray=t.maskedImgArray.bind(Object(b.a)(t)),t.test=t.test.bind(Object(b.a)(t)),t}return Object(p.a)(n,[{key:"loadModel",value:function(){var t=Object(l.a)(d.a.mark((function t(){var e,n,a,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("jsonuploads").files,n=document.getElementById("sharduploads").files,a=Array.from(e).concat(Array.from(n)),console.log(a),t.next=6,y.e(y.d.browserFiles(a));case 6:s=t.sent,this.setState({model:s}),console.log(s.summary());case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loadPic",value:function(){console.log("loading"),this.setState({picurl:URL.createObjectURL(document.getElementById("picuploads").files[0])}),console.log(this.state),this.setState({imguploaded:!0})}},{key:"getTensor",value:function(){var t=Object(l.a)(d.a.mark((function t(){var e,n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=y.a.fromPixels(document.getElementById("pic")).resizeBilinear([64,64]),n=y.i([.2989,.587,.114]),e=y.h(e.mul(n),2).expandDims(-1).expandDims(0),this.setState({tensor:e}),t.next=6,e.array();case 6:a=t.sent,console.log(a[0]);case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"predict",value:function(){var t=Object(l.a)(d.a.mark((function t(){var e,n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.state.model,n=e.predict(this.state.tensor),t.next=4,n.array();case 4:a=t.sent,this.setState({predictarray:a}),console.log(a);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"scorecam",value:function(){var t=Object(l.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.state.model;case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"activationMap",value:function(){var t=Object(l.a)(d.a.mark((function t(){var e,n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.state.model,t.next=3,y.f({inputs:e.input,outputs:e.getLayer("add_5").output}).predict(this.state.tensor);case 3:n=t.sent,a=y.c.resizeBilinear(n,[64,64]),this.setState({actmap:a}),y.a.toPixels(this.state.actmap.squeeze().gather([0],2).squeeze().cast("int32"),document.getElementById("aCanvas"));case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"range",value:function(t,e){return"undefined"==typeof e&&(e=t,t=0),Object(c.a)(Array(e).keys()).slice(t,e)}},{key:"maskedImgArray",value:function(){this.state.model;try{for(var t=[],e=y.g(255),n=this.state.tensor.squeeze().cast("int32"),a=this.state.actmap.squeeze(),s=this.state.actmap.squeeze().arraySync()[0][0].length,r=0;r<s;r++){this.setState({maskedImgArrayprogress:r});var i=a.gather([r],2).squeeze().cast("int32").mul(n).div(e);t.push(i),this.setState({maskedImgArray:t})}}catch(c){console.log(c)}}},{key:"test",value:function(){for(var t=this.state.model,e=y.b([1024,2]),n=0;n<this.state.maskedImgArray.length;n++){var a=t.predict(this.state.maskedImgArray[n].expandDims(-1).expandDims(0));e.set(a.arraySync()[0],n,0),e.set(a.arraySync()[1],n,1),console.log(n+"/1024")}var s=e.toTensor();this.setState({test:s})}},{key:"render",value:function(){return Object(j.jsx)("div",{className:"dev",children:Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"input-group",children:Object(j.jsx)("input",{type:"file",className:"form-control",id:"jsonuploads","aria-describedby":"inputGroupFileAddon04","aria-label":"Upload"})}),Object(j.jsx)("br",{}),Object(j.jsxs)("div",{className:"input-group",children:[Object(j.jsx)("input",{type:"file",class:"form-control",id:"sharduploads",multiple:!0,"aria-describedby":"inputGroupFileAddon04","aria-label":"Upload"}),Object(j.jsx)("button",{className:"btn btn-outline-secondary",onClick:this.loadModel,type:"button",id:"inputGroupFileAddon04",children:"loadModel"})]}),Object(j.jsx)("br",{}),Object(j.jsxs)("div",{className:"input-group",children:[Object(j.jsx)("input",{type:"file",class:"form-control",id:"picuploads","aria-describedby":"inputGroupFileAddon04","aria-label":"Upload"}),Object(j.jsx)("button",{className:"btn btn-outline-secondary",onClick:this.loadPic,type:"button",id:"inputGroupFileAddon04",children:"\xa0loadPic\xa0"})]}),this.state.imguploaded?Object(j.jsxs)("div",{children:[Object(j.jsx)("br",{}),Object(j.jsx)("img",{src:this.state.picurl,id:"pic"}),Object(j.jsx)("br",{})]}):null,Object(j.jsxs)("div",{class:"btn-group",role:"group","aria-label":"Basic example",children:[Object(j.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:this.getTensor,children:"getTensor"}),Object(j.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:this.predict,children:"predict"}),Object(j.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:this.activationMap,children:"actMap"}),Object(j.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:this.maskedImgArray,children:"maskedImgArray"}),Object(j.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:this.test,children:"test"})]}),void 0!==this.state.predictarray?Object(j.jsx)("h1",{children:this.state.predictarray}):null,Object(j.jsx)("canvas",{id:"aCanvas",width:"200",height:"100"})]})})}}]),n}(a.Component),v=f,g=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,307)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),s(t),r(t),i(t)}))};i.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(v,{})}),document.getElementById("root")),g()}},[[305,1,2]]]);
//# sourceMappingURL=main.56d7fba4.chunk.js.map